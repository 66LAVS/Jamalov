from pathlib import Path

from pptx import Presentation


TEMPLATE = Path("Шаблон презентации на защиту ИП.pptx")
OUTPUT = Path("Презентация_Обзор_компьютерных_игр_Жамалов_Салман_Имаммединович.pptx")


SLIDES_CONTENT = [
    (
        "Обзор компьютерных игр",
        [
            "Индивидуальный проект",
            "Выполнил: Жамалов Салман Имаммединович",
            "Нижневартовский социально-гуманитарный колледж",
        ],
    ),
    (
        "Актуальность темы",
        [
            "Игровая индустрия — одно из самых быстрорастущих направлений ИТ.",
            "Компьютерные игры влияют на образование, культуру, экономику и коммуникацию.",
            "Важно оценить не только преимущества игр, но и возможные риски.",
        ],
    ),
    (
        "Цель работы",
        [
            "Провести обзор компьютерных игр и определить их роль в современном обществе.",
        ],
    ),
    (
        "Задачи работы",
        [
            "Изучить историю развития компьютерных игр.",
            "Рассмотреть жанры и платформы.",
            "Провести сравнительный анализ популярных игр.",
            "Сформулировать выводы о перспективах индустрии.",
        ],
    ),
    (
        "Объект и предмет исследования",
        [
            "Объект: компьютерные игры как цифровой продукт.",
            "Предмет: жанровые, технологические и пользовательские особенности современных игр.",
            "Методы: анализ, сравнение, обзор источников и отзывов.",
        ],
    ),
    (
        "1.1 Эволюция компьютерных игр",
        [
            "От аркадных автоматов и приставок — к онлайн-проектам и AAA-играм.",
            "Развитие графики, игровых движков и сетевых технологий.",
            "Современная модель: регулярные обновления и сервисный подход.",
        ],
    ),
    (
        "1.2 Основные жанры",
        [
            "Экшен — динамика и реакция.",
            "RPG — развитие персонажа и сюжет.",
            "Стратегии и симуляторы — планирование и управление ресурсами.",
        ],
    ),
    (
        "1.3 Платформы и технологии",
        [
            "Платформы: ПК, консоли, мобильные устройства.",
            "Игровые движки: Unity, Unreal Engine.",
            "Новые тренды: облачный гейминг, VR/AR, ИИ.",
        ],
    ),
    (
        "1.4 Влияние игр на общество",
        [
            "Положительное влияние: развитие реакции, логики, командных навыков.",
            "Риски: зависимость, токсичное общение, агрессивная монетизация.",
            "Необходима цифровая грамотность и соблюдение возрастных рейтингов.",
        ],
    ),
    (
        "2.1 Практический обзор игр",
        [
            "Рассмотрены: Counter-Strike 2, Dota 2, Minecraft, Cyberpunk 2077, Forza Horizon 5.",
            "Выбор охватывает разные жанры и типы пользовательского опыта.",
        ],
    ),
    (
        "2.2 Сравнительный анализ",
        [
            "Критерии: графика, геймплей, сюжет, техническая стабильность.",
            "Также учитывались доступность для новичков и активность сообщества.",
        ],
    ),
    (
        "2.3 Выбор наиболее качественного продукта",
        [
            "По совокупности критериев выделен Minecraft.",
            "Причины: доступность, образовательный потенциал, активное сообщество, долгосрочная поддержка.",
        ],
    ),
    (
        "2.4 Отзывы пользователей",
        [
            "Игроки ценят стабильность, честный матчмейкинг и прозрачные обновления.",
            "Для сюжетных игр важны оптимизация и глубина повествования.",
        ],
    ),
    (
        "Заключение",
        [
            "Цель проекта достигнута: выполнен теоретический и практический обзор.",
            "Определены ключевые тенденции и факторы качества игр.",
            "Перспективы: развитие ИИ, VR/AR и облачных сервисов в игровой индустрии.",
        ],
    ),
    (
        "Информационные ресурсы",
        [
            "Использовано 15 источников (книги, официальные сайты, аналитические материалы).",
            "Оформление источников выполнено по требованиям методических рекомендаций.",
        ],
    ),
    (
        "Спасибо за внимание!",
        [
            "Готов ответить на вопросы.",
        ],
    ),
]


def set_slide_text(slide, title: str, bullets: list[str]):
    text_shapes = [sh for sh in slide.shapes if getattr(sh, "has_text_frame", False)]
    if not text_shapes:
        return

    # Заголовок
    text_shapes[0].text = title

    # Основной текст в следующей текстовой области, иначе в той же
    target = text_shapes[1] if len(text_shapes) > 1 else text_shapes[0]
    tf = target.text_frame
    tf.clear()
    for i, item in enumerate(bullets):
        p = tf.paragraphs[0] if i == 0 else tf.add_paragraph()
        p.text = item
        p.level = 0


def main():
    prs = Presentation(str(TEMPLATE))

    for i, (title, bullets) in enumerate(SLIDES_CONTENT):
        if i >= len(prs.slides):
            break
        set_slide_text(prs.slides[i], title, bullets)

    prs.save(str(OUTPUT))
    print(OUTPUT)


if __name__ == "__main__":
    main()
